# SPC 経費精算システム MVP要件定義書

## 1. MVPの目的とスコープ

### 1.1 実現する価値
- 紙／Excel依存から脱却
- 申請〜承認〜振込までが回る状態
- 社内カテゴリ管理が可能

### 1.2 本システムで実現すること（MVP）
- 経費申請のオンライン化
- 領収書アップロード + OCR読み取り
- 事務局承認フロー
- 社内カテゴリ（仕訳的役割）管理
- 補助金額算出ロジックの実装
- 振込用データ生成（MVP）
- SPC会員DB連携

### 1.3 対象外
- 会計ソフトとの自動連携（現時点では対象外）
  - CSV/データエクスポートによる手動連携は可
- SPC以外団体対応（本プロジェクト範囲外）
- AI仕訳サジェスト（フル版機能）
- 集計・レポート（フル版機能）
- 金融機関APIによる自動振込（フル版機能）

---

## 2. 利用者

| 区分 | 利用者 | 役割 |
|------|--------|------|
| 会員 | 経費申請を行うユーザー | 申請作成・送信・確認 |
| 事務局 | 確認・承認・差し戻し・振り込み対応 | 申請確認・承認・振込データ生成 |
| 管理者 | マスタ管理・運用管理 | システム管理（フル版で拡張） |

---

## 3. 機能要件（MVP）

### 3.1 会員向け機能

#### 3.1.1 認証・基本機能
- **ログイン**
  - SPC会員DB連携による認証
- **マイページ**
  - 会員情報表示
  - 申請状況サマリー

#### 3.1.2 申請管理
- **申請一覧**
  - 自分の申請一覧表示
  - ステータス別フィルタ
- **申請作成**
  - 新規申請フォーム
  - 必要項目入力
- **申請編集**
  - 下書き状態の申請を編集
  - 差戻しされた申請を修正
- **申請送信**
  - 申請を事務局へ送信
  - ステータスを「申請中」に変更

#### 3.1.3 領収書・OCR機能
- **領収書アップロード**
  - 画像ファイルアップロード
  - 複数ファイル対応（想定）
- **OCR抽出**
  - 日付の自動抽出
  - 金額の自動抽出
  - 店舗名等の自動抽出
- **OCR結果修正**
  - 抽出結果の確認
  - 手動修正機能

#### 3.1.4 ステータス管理
- **申請ステータス確認**
  - 下書き
  - 申請中
  - 差戻し
  - 承認済
  - 却下

---

### 3.2 事務局向け機能

#### 3.2.1 申請管理
- **申請一覧**
  - 全申請の一覧表示
  - 検索機能
  - フィルタ機能
    - 期間フィルタ
    - 会員フィルタ
    - 状態フィルタ
- **申請詳細閲覧**
  - 申請内容の詳細表示
  - 会員情報表示
- **添付領収書確認**
  - アップロードされた領収書の閲覧

#### 3.2.2 承認フロー
- **入力内容確認**
  - 申請内容の精査
  - OCR結果の確認
- **社内カテゴリ設定**
  - 社内カテゴリ（内部分類）の付与
  - ※会計公式科目ではない
- **補助金額算出**
  - 自動算出（提案額）
  - 最終確定額入力
- **承認**
  - 申請を承認
  - ステータスを「承認済」に変更
- **差戻し**
  - コメント必須
  - ステータスを「差戻し」に変更
  - 会員に通知（想定）
- **却下**
  - 申請を却下
  - ステータスを「却下」に変更
- **コメント履歴**
  - 差戻し・承認時のコメント記録
  - 履歴表示

---

### 3.3 振込管理機能

#### 3.3.1 振込データ生成
- **承認済申請抽出**
  - 承認済みの申請を抽出
- **振込対象一覧**
  - 振込対象の申請一覧表示
- **振込金額確認**
  - 振込金額の確認・検証
- **振込データ出力**
  - 銀行フォーマットでのデータ生成
  - CSV等の形式で出力
- **現金対応フラグ**
  - 現金対応が必要な申請にフラグ設定（任意）

---

### 3.4 外部連携機能

#### 3.4.1 SPC会員DB連携
- **会員情報取得**
  - ログイン時の会員情報取得
  - 会員情報の同期
- **部門情報同期**
  - 部門マスタの同期
  - 会員の部門情報取得

---

## 4. 画面一覧（MVP）

| 画面ID | 画面名 | 利用者 | 説明 |
|--------|--------|--------|------|
| SCR-001 | ログイン | 全員 | 認証画面 |
| SCR-002 | マイページ | 会員 | 会員向けトップページ |
| SCR-003 | 申請一覧（会員） | 会員 | 自分の申請一覧 |
| SCR-004 | 申請登録／編集 | 会員 | 申請作成・編集画面 |
| SCR-005 | 申請詳細（会員） | 会員 | 申請内容確認画面 |
| SCR-010 | 申請一覧（事務局） | 事務局 | 事務局向け申請一覧 |
| SCR-011 | 申請詳細／承認 | 事務局 | 承認・差戻し画面 |
| SCR-013 | 振込データ出力 | 事務局 | 振込データ生成画面 |

---

## 5. データモデル（ER概要）

### 5.1 主要エンティティ
- **MEMBER（会員）**
  - 会員情報
  - SPC会員DBと連携
- **DEPARTMENT（部門）**
  - 部門マスタ
  - SPC会員DBと連携
- **EXPENSE_APPLICATION（経費申請）**
  - 申請情報
  - ステータス管理
- **RECEIPT（領収書）**
  - 領収書画像
  - OCR抽出結果
- **INTERNAL_CATEGORY（社内カテゴリ）**
  - 社内カテゴリマスタ
  - 内部分類管理
- **PAYMENT（振込）**
  - 振込情報
  - 振込データ生成用

---

## 6. 業務フロー（MVP）

1. 会員がログイン
2. 経費申請を登録
3. 領収書アップロード
4. OCRでデータ抽出
5. 会員確認 → 申請送信
6. 事務局が内容確認
7. 社内カテゴリ付与
8. 補助金額算出（システム提案 → 事務局確定）
9. 承認 or 差戻し
10. 承認済データから振込データ生成
11. 手動で銀行へ振込実行（MVP）

---

## 7. 非機能要件

### 7.1 パフォーマンス
- レスポンス時間：3秒以内

### 7.2 稼働
- 原則24時間稼働

### 7.3 セキュリティ
- HTTPS必須
- 認証はSPC会員DB前提

### 7.4 拡張性
- AI / 分析前提でデータ設計
- フル版への拡張を考慮した設計

---

## 8. 技術要件（想定）

### 8.1 OCR機能
- 領収書から日付・金額・店舗名等を抽出
- 抽出結果の手動修正機能

### 8.2 データ出力
- 振込データを銀行フォーマットで出力
- CSV形式でのエクスポート対応

### 8.3 外部連携
- SPC会員DBとの連携
  - 会員情報取得
  - 部門情報同期

---

## 9. 想定工数（参考）

- **MVP：60〜80人日**
  - 参考レベル／精査前提

---

## 10. MVPで実現する価値

- 紙／Excel依存から脱却
- 申請〜承認〜振込までが回る状態
- 社内カテゴリ管理が可能
- 将来的なAI活用・分析可能なデータ基盤を整備
